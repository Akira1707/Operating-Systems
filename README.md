# Лаб2 - вариант 5
Волк и козлята — моделирование IPC (Linux, C++)

Данный проект реализует игру **«Волк и семеро козлят»** с использованием различных механизмов **межпроцессного взаимодействия (IPC)** в системе Linux.  
Реализованы три независимых типа соединений между процессами (вариант 5):

- POSIX **очереди сообщений (mq)**
- **именованные каналы (FIFO)**
- **сокеты TCP (sock)**

---

## Цель работы

Написать две независимые программы:

- **host** — процесс-инициатор (*волк*), управляет игрой, создаёт и обслуживает IPC.
- **client** — процесс-клиент (*козлёнок*), подключается к host, отправляет случайные числа и получает статус (жив / мёртв).

Обе программы взаимодействуют через один из трёх типов IPC, выбранный пользователем при запуске.

---

## Сборка проекта
Используется скрипт build.sh:

```bash
./build.sh
```

Или вручную:
```bash
mkdir build
cd build
cmake ..
make
```

После сборки будут созданы исполняемые файлы:

- `host_conn_mq`, `client_conn_mq`
- `host_conn_fifo`, `client_conn_fifo`
- `host_conn_sock`, `client_conn_sock`

---

## Запуск игры

### Очередь сообщений (Message Queue)

В одном терминале:
```bash
./host_conn_mq
```

В другом терминале (или в нескольких):
```bash
./client_conn_mq
```

---

### Именованные каналы (FIFO)

В одном терминале:
```bash
./host_conn_fifo
```

В другом:
```bash
./client_conn_fifo
```

---

### Сокеты (TCP Socket)

В одном терминале:
```bash
./host_conn_sock
```

В другом:
```bash
./client_conn_sock
```

---

## Тестирование всех типов IPC

Для автоматической проверки можно использовать скрипт:
```bash
./test.sh
```

Скрипт последовательно запускает `host` и несколько `client` для всех трёх типов IPC
и демонстрирует работу системы в течение 10 секунд для каждого типа.

---

## Описание игры «Волк и козлята»

- Волк (host) выбирает число от 1 до 100 (вводится пользователем или случайно через 3 секунды).
- Каждый живой козлёнок (client) случайно выбирает число от 1 до 100.
- Мёртвый козлёнок выбирает число от 1 до 50.
- Если разница между числом волка и козлёнка ≤ 70/n — козлёнок спрятался (остался жив).
- Если козлёнок пойман — он становится мёртвым.
- Мёртвый козлёнок может воскреснуть, если его число отличается от числа волка не более чем на 20/n.
- Игра заканчивается, если все козлята мертвы два раунда подряд.

---

## Примечания

- Для синхронизации используется глобальный семафор `sem_open`.
- При тайм-ауте в 5 секунд процессы завершают соединение.
- Код компилируется с флагами `-Wall` и `-Werror`.
- Все соединения реализованы в отдельных файлах с префиксом `conn_`.


